# SC24 Auto Sync

`sc24-auto-sync` is an automated file synchronization tool developed for the SC24 event workflow. This project uses two Python scripts to automatically sync images generated by generative AI in **ComfyUI** from a local machine to a remote server accessible via SSH. The images are then downloaded by a second script to the VideoWall computer.

## Requirements

- An **online server** with SSH access, which serves as the central repository for synchronization.
- **Python 3.x** on both the local generation machine and the VideoWall machine.
- Python dependencies:
  - `paramiko`: For SSH and SFTP functionality.
  - `watchdog`: To monitor the local folder for new files (used in `sync_upload.py`).

**Note:** For SC24, the online server is already set up with SSH access, so no additional configuration is needed for the server.

## How It Works

1. **Image Generation with ComfyUI**:  
   The local generation machine runs **ComfyUI** to produce images using generative AI. A Python script, `sync_upload.py`, monitors the folder where ComfyUI saves these images.

2. **Automatic Upload**:  
   Each time a new image is generated, `sync_upload.py` automatically uploads it to a specified directory on the remote server via SSH.

3. **Image Sync to VideoWall**:  
   A second Python script, `sync_download.py`, runs on the VideoWall computer. This script periodically checks the remote server for new images and downloads them to a local folder, overwriting existing files as necessary.

4. **Displaying Images on the VideoWall**:  
   The VideoWall application accesses the local folder to display synchronized images directly from the remote server.

## Setup

### 1. Clone the Repository

```bash
git clone https://github.com/yourusername/sc24_auto_sync.git
cd sc24_auto_sync
```

### 2. Install Dependencies

Use the provided `requirements.txt` file to install necessary Python libraries:

```bash
pip install -r requirements.txt
```

### 3. Configuration

Each script requires a configuration file with server and folder details.

#### `config_upload.txt` (For `sync_upload.py`)

Create a `config_upload.txt` file in the same directory as `sync_upload.py`:

```plaintext
hostname=SERVER_IP
username=YOUR_USERNAME
password=YOUR_PASSWORD
remote_folder=/path/to/remote/upload_folder
local_folder=C:/path/to/local/upload_folder
```

#### `config_download.txt` (For `sync_download.py`)

Create a `config_download.txt` file in the same directory as `sync_download.py`:

```plaintext
hostname=SERVER_IP
username=YOUR_USERNAME
password=YOUR_PASSWORD
remote_folder=/path/to/remote/download_folder
local_folder=C:/path/to/local/download_folder
```

### 4. Ensure Local Folders Exist

The script will automatically create the local folder specified in the configuration file if it does not exist.

## Usage

### Running `sync_upload.py`

`sync_upload.py` monitors the specified `local_folder` for new files generated by ComfyUI and uploads them to the `remote_folder` on the Linux server.

```bash
python sync_upload.py
```

### Running `sync_download.py`

`sync_download.py` periodically checks the `remote_folder` on the Linux server and downloads any files to the specified `local_folder` on the VideoWall machine, overwriting local copies if they exist.

```bash
python sync_download.py
```

### Notes
- The upload script only uploads new files detected in the local folder.
- The download script overwrites local files with the latest versions from the server.
- You can adjust the interval for the `sync_download.py` scriptâ€™s periodic check by modifying the `interval` argument in the `sync_periodically` function.

## Logging

Each script generates logs:
- **`upload_log.txt`**: Logs file uploads and any errors encountered by `sync_upload.py`.
- **`download_log.txt`**: Logs file downloads and any errors encountered by `sync_download.py`.

## Troubleshooting

1. **Configuration Loading Errors**: Ensure the `config_upload.txt` or `config_download.txt` file is in the same directory as the respective script and that the file is correctly formatted.
2. **File Not Found Errors**: Check that paths in both configuration files exist and are accessible. The script will attempt to create the `local_folder` if it does not exist.
3. **Connection Errors**: Verify the server IP, username, and password in the configuration files and ensure SSH access is configured on the server.

## License

This project is licensed under the MIT License. See the [LICENSE](LICENSE) file for details.

---

### Author
[Asier Arranz](https://github.com/asierarranz)
